---
layout: post
title: 尝试HTML5物理定位
categories:
- lab
tags:
- geo
- geolocation
- html5
published: true
comments: true
permalink: /blog/html5_geolocation_demo
---
<p>geolocation是html5规范中的新特性，它主要通过GPS和IP地址来猜测客户端的上网位置，输出位置信息。换言之，如果没有GPS设备，它将使用后者来猜测你的位置，所以结果不是绝对精准的。</p>

<p>规范的详细文档可浏览：<a href="http://dev.w3.org/geo/api/spec-source.html">http://dev.w3.org/geo/api/spec-source.html</a></p>

<p>当前并不是所有的浏览器都支持geolocation，在目前为止以下浏览器支持该新特性：IE8,safari4,chrome,Opera(我没验证)。但如果你的应用需要在非以上浏览中实现类似geolocation的功能，可以使用google location services,可以参考文章<a href="http://blog.bcse.info/get-geolocation-via-javascript">http://blog.bcse.info/get-geolocation-via-javascript</a></p>

<p>为保障使用者安全，使用该API时浏览器会询问用户是否启用该功能。如图：</p>

<p><a title="Flickr 上 roymax 的 geolocation" href="http://www.flickr.com/photos/roymax/4658866115/"><img src="http://farm2.static.flickr.com/1287/4658866115_efe433b800.jpg" alt="geolocation" width="500" height="75" /></a></p>

<p>只有允许API才生效。</p>

<p>通常使用<span style="color: #000000;"><strong>getCurrentPosition</strong></span>来获取使用者当前的位置，如果需要的跟踪使用者的位置调用<strong>watchPosition</strong>，传闻后者可以为移动设备更节省电力，手上没有移动设备，也并未理解它们之间的分别。</p>

<p>无论使用以上那个，都返回一个Position对象来描述物理位置，它包含调用者的经纬坐标（coords）--经度、纬度、海拨、准确度等等......部分参数是需要具体实现支持的，如果没有将返回默认值null.</p>

<p>下面是geolocation最简单的调用例子：</p>

<p><code> </code></p>

<p><code>&lt;script&gt;</code></p>

<p>if (navigator.geolocation) {</p>

<p>navigator.geolocation.getCurrentPosition(function(position){</p>

<p>alert("latitude = " + position.coords.latitude+ "\nlongitude = " + position.coords.longitude);</p>

<p>});</p>

<p>} else {</p>

<p><span style="white-space: pre;"> </span>error('not supported');</p>

<p>}</p>

<p></p>

<p><code>&lt;/script&gt;</code></p>

<p>它返回了当前的物理位置，并通过警告窗口显现。该API本身是非常简单，期待更多基于该API的新应用产生。当定位信息准确化后，它将改变我们的生活，同时也给我们带来相对的痛苦。当然，只是相对的。。。</p>

<p>以下是<a href="http://html5demos.com/geo">http://html5demos.com/geo</a>上显视壬丰大厦的物理位置
<a title="Flickr 上 roymax 的 renfeng" href="http://www.flickr.com/photos/roymax/4659678304/"><img src="http://farm5.static.flickr.com/4024/4659678304_6e87fdc1fd.jpg" alt="renfeng" width="500" height="467" /></a></p>

<p>参考资料：
<ul>
	<li> <a href="http://html5demos.com/geo">http://html5demos.com/geo</a> ,  相对完整并整合了google map的例子</li>
	<li><span style="color: #0000ee;"><span style="text-decoration: underline;"><a href="http://www.mijia.org/blog/?p=198">http://www.mijia.org/blog/?p=198</a></span></span></li>
	<li><span style="color: #0000ee;"><span style="text-decoration: underline;"><a href="http://dev.w3.org/geo/api/spec-source.html">http://dev.w3.org/geo/api/spec-source.html</a></span></span>，w3关于geo的规范</li>
	<li><span style="color: #0000ee;"><span style="text-decoration: underline;"><a href="https://developer.mozilla.org/En/Using_geolocation#Watching_the_current_position">https://developer.mozilla.org/En/Using_geolocation</a></span></span>，mozilla上的帮助</li>
	<li><span style="color: #0000ee;"><span style="text-decoration: underline;"><a href="http://blog.bcse.info/get-geolocation-via-javascript-2">http://blog.bcse.info/get-geolocation-via-javascript-2</a></span></span>，整合google gear便于支持非html5浏览器</li>
</ul></p>
